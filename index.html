<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RJ Services - Job Listings & Applications</title>
    <style>
        /* CSS Styling */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            color: #333;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #007bff;
            color: white;
            padding: 20px 0;
            text-align: center;
        }

        h1 {
            margin: 0;
        }

        .search-bar {
            margin-top: 10px;
        }

        .search-bar input {
            padding: 10px;
            width: 70%;
            margin-right: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .search-bar button {
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .search-bar button:hover {
            background-color: #0056b3;
        }

        .job-listings {
            margin: 20px;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .jobs-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .job-item {
            background-color: #f9f9f9;
            padding: 15px;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .job-item h3 {
            margin-top: 0;
        }

        .apply-btn {
            margin-top: 10px;
            padding: 10px;
            background-color: #28a745;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .apply-btn:hover {
            background-color: #218838;
        }

        .post-job {
            margin: 20px;
            padding: 20px;
            background-color: white;
            border-radius: 5px;
            border: 1px solid #ddd;
        }

        .post-job form, #apply-form {
            display: flex;
            flex-direction: column;
        }

        .post-job input, .post-job textarea, #apply-form input {
            padding: 10px;
            margin: 10px 0;
            border: 1px solid #ccc;
            border-radius: 5px;
        }

        .post-job button, #apply-form button {
            padding: 10px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        footer {
            text-align: center;
            padding: 10px;
            background-color: #007bff;
            color: white;
        }

        /* Application form modal */
        #apply-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border-radius: 5px;
            border: 1px solid #ddd;
            z-index: 1000;
            width: 300px;
            box-shadow: 0 0 10px rgba(0,0,0,0.3);
        }

        #apply-modal-close {
            align-self: flex-end;
            cursor: pointer;
            color: #aaa;
            font-size: 20px;
        }
    </style>
</head>
<body>

<header>
    <h1>RJ Services - Job Listings</h1>
    <div class="search-bar">
        <input type="text" id="search-input" placeholder="Search for jobs...">
        <button onclick="searchJobs()">Search</button>
    </div>
</header>

<!-- Job Listings Section -->
<section class="job-listings">
    <h2>Available Job Listings</h2>
    <div class="jobs-container" id="jobs-container">
        <!-- Job listings will be dynamically loaded here -->
    </div>
</section>

<!-- Job Post Form Section -->
<section class="post-job">
    <h2>Post a New Job</h2>
    <form id="post-job-form">
        <label for="job-title">Job Title</label>
        <input type="text" id="job-title" placeholder="Enter job title" required>

        <label for="location">Location</label>
        <input type="text" id="location" placeholder="Enter job location" required>

        <label for="salary">Salary Range</label>
        <input type="text" id="salary" placeholder="Enter salary range" required>

        <label for="description">Job Description</label>
        <textarea id="description" placeholder="Enter job description" required></textarea>

        <label for="contact">Contact (Email or WhatsApp)</label>
        <input type="text" id="contact" placeholder="Enter contact email or WhatsApp number" required>

        <button type="submit">Post Job</button>
    </form>
</section>

<!-- Application Form Modal -->
<div id="apply-modal">
    <span id="apply-modal-close" onclick="closeApplyModal()">x</span>
    <h2>Apply for Job</h2>
    <form id="apply-form">
        <label for="applicant-name">Your Name</label>
        <input type="text" id="applicant-name" placeholder="Enter your name" required>

        <label for="applicant-email">Your Email</label>
        <input type="email" id="applicant-email" placeholder="Enter your email" required>

        <label for="resume-link">Resume Link</label>
        <input type="url" id="resume-link" placeholder="Enter link to your resume" required>

        <button type="submit">Submit Application</button>
    </form>
</div>

<footer>
    <p>&copy; 2024 RJ Services | All rights reserved.</p>
</footer>
<script type="module">
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getAnalytics } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-analytics.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    const firebaseConfig = {
      apiKey: "AIzaSyA29bzuGtzVW-j5uH7rcEoQ3Uo5rqH84Bw",
      authDomain: "jobs-c48f6.firebaseapp.com",
      projectId: "jobs-c48f6",
      storageBucket: "jobs-c48f6.firebasestorage.app",
      messagingSenderId: "442042297958",
      appId: "1:442042297958:web:5f8f5cf087b0ab6af6c7a7",
      measurementId: "G-08YTDGG4RL"
    };
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const analytics = getAnalytics(app);

// Function to add a new job post to Firestore
function addJobToFirestore(job) {
    db.collection("jobs").add(job)
        .then((docRef) => {
            console.log("Job added with ID: ", docRef.id);
            displayJobsFromFirestore(); // Refresh job listings
        })
        .catch((error) => {
            console.error("Error adding job: ", error);
        });
}

// Function to retrieve all job posts from Firestore
function displayJobsFromFirestore() {
    const jobsContainer = document.getElementById('jobs-container');
    jobsContainer.innerHTML = ''; // Clear current job listings

    db.collection("jobs").get().then((querySnapshot) => {
        querySnapshot.forEach((doc) => {
            const job = doc.data();
            const jobItem = document.createElement('div');
            jobItem.classList.add('job-item');
            jobItem.innerHTML = `
                <h3>${job.title}</h3>
                <p>Location: ${job.location}</p>
                <p>Salary: ${job.salary}</p>
                <p>Description: ${job.description}</p>
                <p>Contact: <a href="mailto:${job.contact}">${job.contact}</a></p>
                <button class="apply-btn" onclick="openApplyModal('${doc.id}')">Apply</button>
            `;
            jobsContainer.appendChild(jobItem);
        });
    });
}

// On form submission, add job to Firestore instead of localStorage
document.getElementById('post-job-form').addEventListener('submit', function(e) {
    e.preventDefault();

    const jobTitle = document.getElementById('job-title').value;
    const location = document.getElementById('location').value;
    const salary = document.getElementById('salary').value;
    const description = document.getElementById('description').value;
    const contact = document.getElementById('contact').value;

    // Creating job object to store in Firestore
    const job = {
        title: jobTitle,
        location,
        salary,
        description,
        contact,
        applications: []
    };

    // Add job to Firestore
    addJobToFirestore(job);
});

// Call displayJobsFromFirestore on page load to load all jobs
window.onload = displayJobsFromFirestore;
// Posting a job to Firestore
function postJob(job) {
  db.collection("jobs").add(job)
    .then((docRef) => {
      console.log("Job posted with ID: ", docRef.id);
    })
    .catch((error) => {
      console.error("Error posting job: ", error);
    });
}

// Google Sign-In
function googleSignIn() {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider)
    .then((result) => {
      console.log("User signed in:", result.user);
    })
    .catch((error) => {
      console.error("Error signing in:", error);
    });
}

// Sign out
function signOut() {
  auth.signOut().then(() => {
    console.log("User signed out");
  });
}


</script>

<script>
    const jobs = JSON.parse(localStorage.getItem('jobs')) || [];
    let currentJobId = null;

    function displayJobs() {
        const jobsContainer = document.getElementById('jobs-container');
        jobsContainer.innerHTML = ''; 
        jobs.forEach((job, index) => {
            const jobItem = document.createElement('div');
            jobItem.classList.add('job-item');
            jobItem.innerHTML = `
                <h3>${job.title}</h3>
                <p>Location: ${job.location}</p>
                <p>Salary: ${job.salary}</p>
                <p>Description: ${job.description}</p>
                <p>Contact: <a href="mailto:${job.contact}">${job.contact}</a></p>
                <button class="apply-btn" onclick="openApplyModal(${index})">Apply</button>
            `;
            jobsContainer.appendChild(jobItem);
        });
    }

    function openApplyModal(jobIndex) {
        currentJobId = jobIndex;
        document.getElementById('apply-modal').style.display = 'block';
    }

    function closeApplyModal() {
        document.getElementById('apply-modal').style.display = 'none';
    }

    document.getElementById('apply-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const name = document.getElementById('applicant-name').value;
        const email = document.getElementById('applicant-email').value;
        const resumeLink = document.getElementById('resume-link').value;

        const application = { name, email, resumeLink };

        jobs[currentJobId].applications = jobs[currentJobId].applications || [];
        jobs[currentJobId].applications.push(application);

        localStorage.setItem('jobs', JSON.stringify(jobs));

        alert('Application submitted successfully!');
        closeApplyModal();
    });

    document.getElementById('post-job-form').addEventListener('submit', function(e) {
        e.preventDefault();

        const jobTitle = document.getElementById('job-title').value;
        const location = document.getElementById('location').value;
        const salary = document.getElementById('salary').value;
        const description = document.getElementById('description').value;
        const contact = document.getElementById('contact').value;

        jobs.push({ title: jobTitle, location, salary, description, contact, applications: [] });
        localStorage.setItem('jobs', JSON.stringify(jobs));

        displayJobs();
    });

    displayJobs();
</script>


</body>
</html>
